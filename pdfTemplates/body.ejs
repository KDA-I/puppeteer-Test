<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200"
    />
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script&display=swap" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Mulish:ital,wght@0,200..1000;1,200..1000&display=swap"
      rel="stylesheet"
    />
    <title>PDF Template</title>
    <style>
      body {
        font-family: Mulish, sans-serif;
        margin: 10px 0px;
        color: #424242;
      }
      p {
        margin: 0;
      }
      header {
        display: flex;
        justify-content: space-between;
        margin: 0px 0px;
        gap: 20px;
      }
      .mainA4 {
        max-width: 2480px;
      }
      .title {
        color: gray;
        border-radius: 10px;
        margin-top: 0;
      }
      .headerWrapper {
        margin-bottom: 20px;

        h2 {
          margin: 20px 0px 0px 0px;
        }
        h3 {
          margin: 10px 0px 5px 0px;
        }
        h4 {
          color: grey;
          margin: 0px 0px 0px 0px;
          font-weight: 400;
        }

        .headerFirst {
          display: flex;
          flex-direction: column;
          justify-content: flex-start;
          align-items: flex-start;
          flex: 1.2;
        }

        .headerSecond {
          display: flex;
          flex-direction: column;
          justify-content: flex-start;
          align-items: flex-start;
          flex: 0.8;
          font-size: 12px;
          gap: 20px;
          margin-top: 10px;

          .smallIcon {
            font-size: 12px;
            border: 1px solid grey;
            border-radius: 50%;
            min-width: 20px;
            min-height: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
          }
        }

        .headerThird {
          margin-top: 10px;
          display: flex;
          flex-direction: column;
          justify-content: space-between;
          align-items: flex-start;
          flex: 0.8;

          h3 {
            color: #2761c3;
            margin: 0;
          }

          h5{
            margin-top:6px;
          }

          p {
            font-size: 14px;
          }
          span{
            color: #424242;
          }
        }
      }

      .sectionOneWrapper {
        display: flex;
        justify-content: space-between;
        gap: 20px;

        .petDetailsWrapper {
          display: flex;
          justify-content: space-between;
          gap: 20px;
          margin-top: 20px;
          padding: 10px;
          border: 1px solid grey;
          background-color: grey;
        }

        .viewsWrapper {
          display: flex;
          flex-direction: column;
          gap: 20px;
          flex: 0.7;

          .chiefComplaintsWrapper {
            display: flex;
            flex-direction: column;
            background-color: #dde7fe;
            min-height: 200px;
            padding: 10px;
            height: 100%;
            justify-content: flex-start;
            min-width: 670px;
            max-width: 670px;
            .descriptionContainer {
              display: flex;
              flex-direction: column;
              gap: 10px;
            }
          }
          .onExaminationWrapper {
            display: flex;
            height: 100%;
            width: 670px;
            flex-direction: column;
            background-color: #ddf9e0;
            min-height: 200px;
            padding: 10px;
            justify-content: flex-start;
          }
        }

        .petInformationWrapper {
          flex: 0.3;
          background-color: #f6f6f8;
          padding: 10px;
          max-width: 250px;
          min-width: 250px;
          h3 {
            margin: 0px;
            text-align: center;
          }
          h6 {
            margin: 4px;
            text-align: center;
            color: grey;
          }
          .petInfoSubContainer {
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            .imagePlaceHolderContainer {
              display: flex;
              gap: 10px;
              flex-direction: column;
              align-items: center;
            }
            .letterAvatar {
              background-color: #484848;
              color: #dcdcdc;
              font-size: 40px;
              border-radius: 50%;
              width: 60px;
              height: 60px;
              display: flex;
              justify-content: center;
              align-items: center;
              margin: 10px 0px;
              border: 1px solid grey;
              box-shadow: 0px 0px 2.1px 0px grey;
            }
            .petRelatedInformationContainer {
              display: flex;
              flex-direction: column;
              gap: 10px;
              padding: 10px;
              h4 {
                margin: 0px;
              }
              .labelValueContainer {
                display: flex;
                gap: 10px;
                .label {
                  min-width: 45px;
                  font-size: 12px;
                  color: grey;
                  text-align: left;
                }
                .value {
                  font-size: 12px;
                  font-weight: bolder;
                  text-align: left;
                }
              }
            }
          }
        }
      }

      .onInvestigationWrapper {
        margin-top: 40px;
        flex-direction: column;
        width: 65%;
        min-width: 670px;
        max-width: 670px;
        background-color: #e1deff;
        display: flex;
        min-height: 200px;
        padding: 10px;
        justify-content: flex-start;
        .investigationSubWrapper{
          display: flex;
          flex-direction: column;
          gap: 20px;
          font-size: 14px;
          padding: 10px;
        }
      }
      .onTreatmentWrapper {
        background-color: #f8dfff;
        display: flex;
        flex-direction: column;
        width: 65%;
        min-width: 670px;
        max-width: 670px;
        min-height: 200px;
        padding: 10px;
        margin-top: 40px;
        justify-content: flex-start;
        .medicationContainer {
          display: flex;
          padding: 10px;
          flex-direction: column;
          gap: 20px;
          font-size: 14px;
        }
      }
      .diagnosisAndPrognosisWrapper {
        background-color: #dde7fe;
        display: flex;
        min-width: 670px;
        max-width: 670px;
        margin-top: 40px;
        width: 65%;
        flex-direction: column;
        min-height: 200px;
        padding: 10px;
        justify-content: flex-start;
        .tentativeDiagnosisSubWrapper {
          padding: 10px;
          font-size: 14px;
          display: flex;
          flex-direction: column;
          gap: 20px;
          .diagnosis-container {
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
          }
        }
      }
      .followupsWrapper {
        background-color: #e1deff;
        display: flex;
        margin-top: 40px;
        width: 65%;
        min-width: 670px;
        max-width: 670px;

        flex-direction: column;
        min-height: 200px;
        padding: 10px;
        justify-content: flex-start;

        .followUpSubWrapper {
          padding: 10px;
          font-size: 14px;
          display: flex;
          flex-direction: column;
          gap: 20px;
          .typeFollowUpConatiner {
            display: flex;
            flex-direction: column;
            gap: 20px;
            .followUpContent {
              padding-left: 20px;
              display: flex;
              flex-direction: column;
              gap: 10px;
            }
          }
          .followUp-chip {
            padding: 5px 10px;
            max-width: max-content;
            background-color: #005acd;
            color: white;
            box-shadow: 2px 0px 2.3px 0px grey;
          }
          .nextVisit-chip {
            padding: 5px 10px;
            max-width: max-content;
            background-color: #536255;
            color: white;
            box-shadow: 2px 0px 2.3px 0px grey;
          }
        }
      }
      .thankYouContainer {
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        gap: 10px;
        margin-top: 20px;
        padding: 10px;
        min-height: 150px;
      }
      .doctorSignature {
        display: flex;
        flex-direction: column;
        margin: 50px;
        gap: 10px;
        padding: 10px;
        justify-content: flex-end;
        align-items: end;
        min-height: 150px;
      }
      .onExaminationWrapper {
        display: flex;
        width: 65%;
        flex-direction: column;
        background-color: #ddf9e0;
        min-height: 200px;
        padding: 10px;
        min-width: 670px;
        max-width: 670px;
        justify-content: flex-start;
        margin-top: 40px;
        .examinationSubWrapper {
          padding: 10px;
          font-size: 14px;
          display: flex;
          flex-direction: column;
          gap: 20px;
        }
      }
      .adviceWrapper {
        background-color: #ddf9e0;
        display: flex;
        min-width: 670px;
        max-width: 670px;
        flex-direction: column;
        padding: 10px;
        width: 65%;
        margin-top: 40px;
        justify-content: flex-start;
        .adviceSubWrapper {
          font-size: 14px;
          padding: 10px;
          display: flex;
          flex-direction: column;
          gap: 20px;
        }
      }
    </style>
  </head>
  <body>
    <div class="mainA4">
      <%-
      include('./header/header',{treatmentSheetTitle:title, createdBy, createdAt, organization})
      %>
      <!-- container wrapping chief complaints, OnExamination and petDetails section -->
      <% let petDetailsRendered = false; %> <% items.forEach((item) => { %> <%
      if (item.type === "CHIEF_COMPLAINT" || item.type === "EXAMINATION" || item.type === "INVESTIGATION" || item.type === "MEDICATION" || item.type === "TENTATIVE_DIAGNOSIS_AND_PROGNOSIS" || item.type === "FOLLOW_UP" || item.type === "ADVICE" || petDetails) { %>

      <div id="sectionOne" class="sectionOneWrapper">
        <!--  -->
 
        <% if (item.type === "CHIEF_COMPLAINT" && (item.data.description
        ||item.data.complaintEntries)) { %>
        <!-- chief complaints  -->
        <div class="viewsWrapper">
          <div id="chiefComplaints" class="chiefComplaintsWrapper">
            <%-
            include('./components/ViewTitle/viewTitle',{title:'Chief_Complaints',symbol:'C/C',color:'#c1d4fc'})
            %> <%- include('./views/chiefComplaints',item.data) %>
          </div>
          <% } %>

          <!--  -->

          <% if (item.type === "EXAMINATION" && (item.data.description ||
          item.data.vitalGroup || item.data.vitals.length >0 )) { %>
          <!-- OnExamination -->
          <div id="onExamination" class="onExaminationWrapper">
            <%-
            include('./components/ViewTitle/viewTitle',{title:'On_Examination',symbol:'O/E',color:'#abf6b1'})
            %> <%- include('./views/onExamination',item.data) %>
          </div>



          <% } %> <% if (item.type === "INVESTIGATION" && item.data.items.length >0) {
          %>
      
          <!--Investigation-->
          <div id="Investigation" class="onInvestigationWrapper">
            <%-
            include('./components/ViewTitle/viewTitle',{title:'Investigation',symbol:'I',color:'#d6d0fe'})
            %> <%- include('./views/investigation',item.data) %>
          </div>
          <% } %>

          <!--  -->

          <% if (item.type === "MEDICATION" &&( item.data.items.length > 0 ||
          item.data.description)) { %>
          <!-- Treatment -->
          <div id="Treatment" class="onTreatmentWrapper">
            <%-
            include('./components/ViewTitle/viewTitle',{title:'Treatment',symbol:'Rx',color:'#f5d1ff'})
            %> <%- include('./views/medication',item.data) %>
          </div>
          <% } %>

          <!--  -->

          <% if (item.type === "TENTATIVE_DIAGNOSIS_AND_PROGNOSIS" &&
          (item.data.tentativeDiagnosis || item.data.prognosis) ) { %>
          <!-- diagnosis and prognosis -->
          <div id="diagnosisAndPrognosis" class="diagnosisAndPrognosisWrapper">
            <%-
            include('./components/ViewTitle/viewTitle',{title:'Diagnosis_And_Prognosis',symbol:'TDx',color:'#c1d4fe'})
            %> <%- include('./views/tentativeDiagnosis',item.data) %>
          </div>
          <% } %>

          <!--  -->

          <% if ( item.type==='FOLLOW_UP' && item.data.items.length >0) { %>
          <!-- Follow up -->
          <div id="adviceAndFollowups" class="followupsWrapper">
            <%-
            include('./components/ViewTitle/viewTitle',{title:'FollowUps',symbol:'F/U',color:'#d6d0ff'})
            %> <%- include('./views/followUp',item) %>
          </div>
          <% } %>

          <!--  -->

          <% if ( item.type==='ADVICE' && item.data) { %>
          <!-- Follow up -->
          <div id="advice" class="adviceWrapper">
            <%-
            include('./components/ViewTitle/viewTitle',{title:'Advice',symbol:'A',color:'#abf6b1'})
            %> <%- include('./views/advice',item.data) %>
          </div>
          <% } %>
        </div>

        <!--  -->

        <% if(pet && !petDetailsRendered) { %>
        <!-- Pet Details  -->
        <div class="petInformationWrapper">
          <%- include('./views/petCard',pet) %>
        </div>
        <% petDetailsRendered = true; %> <% } %>

        <!--  -->

      </div>
      <% } %>

      <!-- Other Views -->

      <% }) %>

      <!-- Thank you section -->
      <div class="thankYouContainer">
        <p><strong>Thank you</strong></p>
        <% if(organization && organization.thankYouMessage) { %>
        <p>
          <%= organization.thankYouMessage || '' %>
        </p>
        <% } %>
      </div>

      <!-- Doctor signature -->

      <div class="doctorSignature">
       <div style="width:fit-content;display: flex; flex-direction: column;max-width: 300px;">
        <% if (createdBy && createdBy.signature) { %>
        <img
          src="<%= createdBy.signature %>"
          alt="Doctor's Signature"
          style="
            width: 100%;
            height: 150px;
            object-fit: cover;
            border-radius: 8px;
            margin-right: 30px;
          "
        />
        <% } else { %> 
          <p style="text-align: center; font-family: 'Dancing Script', cursive; font-size: 36px; font-style: italic; transform: rotate(-5deg); display: inline-block;">
            <%= createdBy.firstName + " " + createdBy.lastName %>
          </p>
        <% } %>
        <h4
          style="
            border-top: 1px solid black;
            padding-top: 10px;
            width: 270px;
            text-align: center;
            margin-bottom: 0px;
            color: #2761c3;
          "
        >
          <% if (createdBy) { %> <%= 'Dr. ' + createdBy.firstName + ' ' + createdBy.lastName %> <% } else { %> Doctor Signature
          <% } %>

        </p>
        <h5
        style="
        margin-top:6px;
          width: 270px;
          text-align: center;
        ">
        <% if (createdBy.highestDegree) { %> <%= createdBy.highestDegree %> <% } %>
        </h5>
      </div>
    </div>
      </div>
    </div>
  </body>
</html>
