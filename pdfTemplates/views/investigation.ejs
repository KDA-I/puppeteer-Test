<div class="investigationSubWrapper">
  <% if (items.length > 0) { %>
  <div style="border-collapse: collapse; width: 100%">
    <div style="display: flex; padding: 5px; color: grey; max-width: 800px">
      <div style="flex: 0.3">TestGroup Name</div>
      <div style="flex: 0.2">Recorded At</div>
      <div style="flex: 0.3">Investigation Items</div>
      <div style="flex: 0.2">Attachments</div>
    </div>

    <% items.forEach((entry, index) => { %>
    <div
      style="display: flex; font-size: 14px; font-weight: 700; max-width: 800px"
    >
      <div
        style="flex: 0.3; padding: 6px;
                background-color: #ffff;
                margin: 0px 5px 0px 0px;
                border-top-right-radius: <% if (index === 0) { %> 5px <% } %>;
                border-top-left-radius: <% if (index === 0) { %> 5px <% } %>;
                border-bottom-right-radius: <% if (index === items.length-1) { %> 5px <% } %>;
                border-bottom-left-radius: <% if (index === items.length-1) { %> 5px <% } %>;"
      >
        <%= entry.name %>
      </div>
      <div
        style="flex: 0.2; padding: 6px;
                background-color: #ffff;
                margin: 0px 5px 0px 0px;
                border-top-right-radius: <% if (index === 0) { %> 5px <% } %>;
                border-top-left-radius: <% if (index === 0) { %> 5px <% } %>;
                border-bottom-right-radius: <% if (index === items.length-1) { %> 5px <% } %>;
                border-bottom-left-radius: <% if (index === items.length-1) { %> 5px <% } %>;"
      >
        <%= new Date(entry.createdAt).toLocaleDateString() %>
      </div>
      <div
        style="flex: 0.3; padding: 6px;
                background-color: #ffff;
                margin: 0px 5px 0px 0px;
                border-top-right-radius: <% if (index === 0) { %> 5px <% } %>;
                border-top-left-radius: <% if (index === 0) { %> 5px <% } %>;
                border-bottom-right-radius: <% if (index === items.length-1) { %> 5px <% } %>;
                border-bottom-left-radius: <% if (index === items.length-1) { %> 5px <% } %>;"
      >
        <% if (entry.result.resultItems.length > 0) { %>
        <ul style="margin: 0px; padding: 0px 0px 0px 20px">
          <% entry.result.resultItems.forEach((item) => { %>
          <li><%= item.displayName %></li>

          <p style="padding: 0px 0px 0px 20px"><%= item.comments %></p>
          <% }) %>
        </ul>
        <% } else { %>
        <p>-</p>
        <% } %>
      </div>
      <div
        style="flex: 0.2; padding: 6px;
                background-color: #ffff;
                display: flex;
                flex-direction: column;
                gap: 20px;
                margin: 0px 5px 0px 0px;
                border-top-right-radius: <% if (index === 0) { %> 5px <% } %>;
                border-top-left-radius: <% if (index === 0) { %> 5px <% } %>;
                border-bottom-right-radius: <% if (index === items.length-1) { %> 5px <% } %>;
                border-bottom-left-radius: <% if (index === items.length-1) { %> 5px <% } %>;"
      >
        <% if(entry.result.resultAttachments.length > 0) { %> <%
        entry.result.resultAttachments.map((item)=> { %>
        <button
          style="
            background-color: white;
            border: 1px solid #d3d0eb;
            border-radius: 2px;
            display: flex;
            padding: 6px;
            gap: 4px;
            max-width: 110px;
            align-items: center;
            width: max-content;
          "
        >
          <span
            class="material-symbols-outlined"
            style="
              color: white;
              display: flex;
              align-items: center;
              justify-content: center;
              font-size: 17px;
              z-index: 2;
              max-width: 80px;
              background-color: #d7d1ff;
              border-radius: 30%;
              height: 25px;
              width: 25px;
            "
          >
            description
          </span>

          <a
            href="<%= item.path %>"
            title="<%= item.originalFileName %>"
            onclick="window.open(this.href, '_blank')"
            style="
              text-decoration: none;
              color: #5b5b5b;
              font-weight: 700;
              max-width: 80px;
              display: inline-block;
              overflow: hidden;
              white-space: nowrap;
              text-overflow: ellipsis;
            "
            target="_blank"
            ><%= item.originalFileName %>
          </a>

          <span
            class="material-symbols-outlined"
            style="color: #a79bff; align-self: flex-end; font-size: 14px"
          >
            trending_flat
          </span>
        </button>
        <% }) } %>
      </div>
    </div>
    <% }) %>
  </div>
  <% } %>
</div>
